<!DOCTYPE html><html class="appearance-auto" lang="zh-TW"><head><meta charset="UTF-8"><title>Robot Framework - 使用 config.ini 管理環境變數 - sqz777's blog</title><meta name="description" content="這篇會介紹：

為何要使用 config.ini
Variables 在 *** Settings ***
如何使用 config.ini

安安 我來填坑了

為什麼要使用 config.ini透過 config.ini 可以

根據環境定義不同的環境變數
避免將機敏資料寫在程式碼中
避免第三.."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><meta name="image" content="https://sqz777.com/img/2021-204911/1636375721.png"><meta name="original-source" content="https://sqz777.com/2021/11/08/2021-204911/"><link rel="canonical" href="https://sqz777.com/2021/11/08/2021-204911/"><meta property="og:locale" content="zh-TW"><meta property="og:type" content="article"><meta property="og:title" content="Robot Framework - 使用 config.ini 管理環境變數 - sqz777's blog"><meta property="og:description" content="這篇會介紹：

為何要使用 config.ini
Variables 在 *** Settings ***
如何使用 config.ini

安安 我來填坑了

為什麼要使用 config.ini透過 config.ini 可以

根據環境定義不同的環境變數
避免將機敏資料寫在程式碼中
避免第三.."><meta property="og:url" content="https://sqz777.com/2021/11/08/2021-204911/"><meta property="og:site_name" content="SQZ777's blog"><meta property="og:image" content="https://sqz777.com/img/2021-204911/1636375721.png"><meta property="fb:app_id" content="966242223397117"><meta name="twitter:title" content="Robot Framework - 使用 config.ini 管理環境變數 - sqz777's blog"><meta name="twitter:image" content="https://sqz777.com/img/2021-204911/1636375721.png"><meta name="twitter:description" content="這篇會介紹：

為何要使用 config.ini
Variables 在 *** Settings ***
如何使用 config.ini

安安 我來填坑了

為什麼要使用 config.ini透過 config.ini 可以

根據環境定義不同的環境變數
避免將機敏資料寫在程式碼中
避免第三.."><meta name="twitter:card" content="summary_large_image"><meta name="google-site-verification" content="lTAMT4U8v-CtkYRIo8AmGaACB3EikdUYpiTHAylwGPE"><!-- Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-4N118JY08V"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-4N118JY08V');</script><!-- End Google Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="SQZ777's blog" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">sqz777's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Robot Framework - 使用 config.ini 管理環境變數</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">點擊返回開頭</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首頁</a></h3><h3 class="is-inline-block"><a href="/about">關於我</a></h3><h3 class="is-inline-block"><a href="/archives">文章列表</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首頁</a></h3><h3 class="is-inline-block"><a href="/about">關於我</a></h3><h3 class="is-inline-block"><a href="/archives">文章列表</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%BA%E4%BB%80%E9%BA%BC%E8%A6%81%E4%BD%BF%E7%94%A8-config-ini"><span class="toc-text">為什麼要使用 config.ini</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Variables-%E5%9C%A8-Settings"><span class="toc-text">Variables 在 *** Settings ***</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Getting-variables-directly-from-a-module-%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="toc-text">Getting variables directly from a module 的方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Getting-variables-from-a-special-function-%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">Getting variables from a special function 的方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-config-ini"><span class="toc-text">如何使用 config.ini</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/config"><i class="tag post-item-tag">config</i></a><a href="/tags/RobotFramework"><i class="tag post-item-tag">RobotFramework</i></a><a href="/tags/%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8"><i class="tag post-item-tag">環境變數</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Robot Framework - 使用 config.ini 管理環境變數</h1><time class="has-text-grey" datetime="2021-11-08T00:00:00.000Z">2021-11-08</time><article class="mt-2 post-content"><p>這篇會介紹：</p>
<ul>
<li>為何要使用 config.ini</li>
<li>Variables 在 *** Settings ***</li>
<li>如何使用 config.ini</li>
</ul>
<p>安安 我來填坑了</p>
<p><img src="/img/2021-204911/1636375721.png"></p>
<h2 id="為什麼要使用-config-ini"><a href="#為什麼要使用-config-ini" class="headerlink" title="為什麼要使用 config.ini"></a>為什麼要使用 config.ini</h2><p>透過 config.ini 可以</p>
<ul>
<li>根據環境定義不同的環境變數</li>
<li>避免將機敏資料寫在程式碼中</li>
<li>避免第三方服務變更時，有大量的檔案需要被變更</li>
</ul>
<p>一般來說在開發任何的程式時都會有環境的區別，使用 config 檔案可以，除了環境的區別之外，還有不適合直接寫在程式碼中的資料例如：token、API 的 URL 等</p>
<h2 id="Variables-在-Settings"><a href="#Variables-在-Settings" class="headerlink" title="Variables 在 *** Settings ***"></a>Variables 在 *** Settings ***</h2><p>在知道如何使用 config.ini 之前須要先知道 Variables 在 Settings 中的作用是什麼</p>
<p>根據 <a target="_blank" rel="noopener" href="https://robotframework.org/robotframework/latest/RobotFrameworkUserGuide.html#variable-files">Robot Framework 的文件</a>可以看到 Variables 有兩種方式可以透過 .py 引入變數</p>
<ul>
<li>Getting variables directly from a module</li>
<li>Getting variables from a special function</li>
</ul>
<h3 id="Getting-variables-directly-from-a-module-的方式"><a href="#Getting-variables-directly-from-a-module-的方式" class="headerlink" title="Getting variables directly from a module 的方式"></a>Getting variables directly from a module 的方式</h3><p>官方定義：</p>
<p><em>Variables are specified as module attributes. In simple cases, the syntax is so simple that no real programming is needed. For example, creates a variable with the specified text as its value. One limitation of this approach is that it does not allow using arguments.MY_VAR &#x3D; ‘my value’$&#x2F;{MY_VAR&#x2F;}</em></p>
<p>以官方定義來說就可以直接看到這個方式的缺點就是沒有支援使用 arguments.MY_VAR 的方式使用變數</p>
<p>以範例來看使用這種方式的結果會是這樣</p>
<p>python 的程式碼：</p>
<pre><code>MY_NAME = &quot;SQZ777&quot;
</code></pre>
<p>.robot 的程式碼如下</p>
<pre><code>*** Settings ***
Variables    test_variables.py

*** Test Cases ***
Test variable in python
    Log To Console    My Name In Python File Is $/&#123;_MY_NAME/&#125;
</code></pre>
<p>執行結果就可以看到</p>
<p><img src="/img/2021-204911/1636374905.png"></p>
<h3 id="Getting-variables-from-a-special-function-的方法"><a href="#Getting-variables-from-a-special-function-的方法" class="headerlink" title="Getting variables from a special function 的方法"></a>Getting variables from a special function 的方法</h3><p>官方定義：</p>
<p><em>An alternative approach for getting variables is having a special function (also camelCase syntax is possible) in a variable file. If such a function exists, Robot Framework calls it and expects to receive variables as a Python dictionary or a Java with variable names as keys and variable values as values. Created variables can be used as scalars, lists, and dictionaries exactly like when getting variables directly from a module, and it is possible to use and prefixes to make creating list and dictionary variables more explicit. The example below is functionally identical to the first example related to getting variables directly from a module.get_variablesgetVariablesMapLIST__DICT__</em></p>
<p>簡單來說，透過這個方式就可以使變數有「環境」這一層的定義，除此之外還要注意的是，python 的檔案中要定義 function 的名稱為 <strong>get_variables</strong></p>
<p>直接來示範吧！</p>
<p>python 的程式碼：</p>
<pre><code>def get_variables():
    var = &quot;BLOG_ENV.MY_NAME&quot;
    variables = /&#123;/&#125;
    variables[var] = &quot;SQZ777&quot;
    return variables
</code></pre>
<p>.robot 的程式碼如下</p>
<pre><code>*** Settings ***
Variables    test_variables.py

*** Test Cases ***
Test variable in python
    Log To Console    My Name In Python File Is $/&#123;BLOG_ENV.MY_NAME/&#125;
</code></pre>
<p>在這裡就可以注意到我的變數已經可以隸屬於不同的環境了（BLOG_ENV 中的 MY_NAME）</p>
<h2 id="如何使用-config-ini"><a href="#如何使用-config-ini" class="headerlink" title="如何使用 config.ini"></a>如何使用 config.ini</h2><p>了解了兩種不同的引入環境變數的方式終於來到最後了解如何使用 config.ini 的部分啦！</p>
<p>透過 configparser 讀取 config.ini ，再將檔案中所有被定義好的變數回傳給 Robot Framework 就可以達成使用 config.ini 的方法</p>
<p>python 的程式碼：</p>
<pre><code>import configparser
def get_variables(config_path=&quot;./config.ini&quot;):
    config = configparser.ConfigParser()
    config.read(config_path)

    variables = /&#123;/&#125;
    print(config.sections)
    for section in config.sections():
        for key, value in config.items(section):
            var = &quot;%s.%s&quot; % (section, key)
            variables[var] = value
    return variables
</code></pre>
<p>config.ini 內容：</p>
<pre><code>[BLOG_ENV]
MARVEL_URL = &lt;http://gateway.marvel.com/&gt;
MARVEL_PUBLIC_KEY = 你的 public key
MARVEL_PRIVATE_KEY = 你的 private key
</code></pre>
<p>在 robot 中使用 config，如下圖</p>
<p><img src="/img/2021-204911/1636374936.png"></p>
<p>在這裡就會出現一個疑問，這樣不就等於環境被寫死了嗎？</p>
<p><img src="/img/2021-204911/1636374948.png"></p>
<p>所以這邊為了讓使用上更方便，環境的定義可以透過 command line 來傳入，在執行 Robot Framework 時，代入參數，如下</p>
<pre><code>python -m robot --variable ENV:BLOG_ENV marvel.robot
</code></pre>
<p>而 .robot 的檔案則須要改成取用 ENV 這個在 command line 中傳入的變數。</p>
<p><img src="/img/2021-204911/1636374966.png"></p>
<p>這樣就能執行到指定的環境與變數囉!</p>
<p>感謝收看 &lt;(_ _)&gt;</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2021/11/16/2021-224604/" title="Robot Framework - Suite Setup V.S Test Setup"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一頁: Robot Framework - Suite Setup V.S Test Setup</span></a><a class="button is-default" href="/2021/10/17/2021-191743/" title="Robot Framework - 介紹一下"><span class="has-text-weight-semibold">下一頁: Robot Framework - 介紹一下</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="SQZ777/sqz777-blog" src="https://utteranc.es/client.js" issue-term="title" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/sqz777"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> sqz777 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>